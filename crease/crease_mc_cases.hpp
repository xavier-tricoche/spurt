#include <array>

namespace spurt {

namespace marching_cubes {

int vertices[][3] = { {0, 0, 0}, {1, 0, 0}, {1, 1, 0}, {0, 1, 0 },
                { 0, 0, 1 }, { 1, 0, 1 }, { 1, 1, 1 }, { 0, 1, 1 } };

int edges[][4] = { { 0, 2, 4, 6 }, { 3, 7, 1, 5 }, { 8, 9, 11, 10 } };

int canonical_edge_coordinates[][2][3] = 
        { {{ 0, 0, 0 }, { 1, 0, 0 }}, // 0
          {{ 1, 0, 0 }, { 1, 1, 0 }}, // 1
          {{ 0, 1, 0 }, { 1, 1, 0 }}, // 2 
          {{ 0, 0, 0 }, { 0, 1, 0 }}, // 3
          {{ 0, 0, 1 }, { 1, 0, 1 }}, // 4
          {{ 1, 0, 1 }, { 1, 1, 1 }}, // 5
          {{ 0, 1, 1 }, { 1, 1, 1 }}, // 6
          {{ 0, 0, 1 }, { 0, 1, 1 }}, // 7
          {{ 0, 0, 0 }, { 0, 0, 1 }}, // 8
          {{ 1, 0, 0 }, { 1, 0, 1 }}, // 9
          {{ 1, 1, 0 }, { 1, 1, 1 }}, // 10
          {{ 0, 1, 0 }, { 0, 1, 1 }} }; // 11

int canonical_edge_indices[][2] = {
    {0, 1}, {1, 2}, {2, 3}, {3, 0}, 
    {4, 5}, {5, 6}, {6, 7}, {7, 4},
    {0, 4}, {1, 5}, {2, 6}, {3, 7}
};

int canonical_face_indices[][4] = {
    { 0, 1, 2, 3 }, { 4, 5, 6, 7 }, 
    { 0, 1, 5, 4 }, { 1, 2, 6, 5 }, 
    { 2, 3, 7, 6 }, { 3, 0, 4, 7 } 
};

int canonical_face_edge_indices[][4] = {
    { 0, 1, 2, 3 }, { 4, 5, 6, 7 },
    { 0, 9, 4, 8 }, { 1, 10, 5, 9 },
    { 2, 11, 6, 10 }, { 3, 8, 7, 11 }
};

char triTable[256][16] ={
     {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1}, // 0
     {0, 8, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},    // 1
     {0, 1, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},    // 2
     {1, 8, 3, 9, 8, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},       // 3
     {1, 2, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},   // 4
     {0, 8, 3, 1, 2, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 5
     {9, 2, 10, 0, 2, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 6
     {2, 8, 3, 2, 10, 8, 10, 9, 8, -1, -1, -1, -1, -1, -1, -1},        // 7
     {3, 11, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},   // 8
     {0, 11, 2, 8, 11, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},     // 9
     {1, 9, 0, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 10
     {1, 11, 2, 1, 9, 11, 9, 8, 11, -1, -1, -1, -1, -1, -1, -1},       // 11
     {3, 10, 1, 11, 10, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},    // 12
     {0, 10, 1, 0, 8, 10, 8, 11, 10, -1, -1, -1, -1, -1, -1, -1},      // 13
     {3, 9, 0, 3, 11, 9, 11, 10, 9, -1, -1, -1, -1, -1, -1, -1},       // 14
     {9, 8, 10, 10, 8, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},    // 15
     {4, 7, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},    // 16
     {4, 3, 0, 7, 3, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},       // 17
     {0, 1, 9, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},       // 18
     {4, 1, 9, 4, 7, 1, 7, 3, 1, -1, -1, -1, -1, -1, -1, -1},          // 19
     {1, 2, 10, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 20
     {3, 4, 7, 3, 0, 4, 1, 2, 10, -1, -1, -1, -1, -1, -1, -1},         // 21
     {9, 2, 10, 9, 0, 2, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1},         // 22
     {2, 10, 9, 2, 9, 7, 2, 7, 3, 7, 9, 4, -1, -1, -1, -1},            // 23
     {8, 4, 7, 3, 11, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 24
     {11, 4, 7, 11, 2, 4, 2, 0, 4, -1, -1, -1, -1, -1, -1, -1},        // 25
     {9, 0, 1, 8, 4, 7, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1},         // 26
     {4, 7, 11, 9, 4, 11, 9, 11, 2, 9, 2, 1, -1, -1, -1, -1},          // 27
     {3, 10, 1, 3, 11, 10, 7, 8, 4, -1, -1, -1, -1, -1, -1, -1},       // 28 
     {1, 11, 10, 1, 4, 11, 1, 0, 4, 7, 11, 4, -1, -1, -1, -1},         // 29
     {4, 7, 8, 9, 0, 11, 9, 11, 10, 11, 0, 3, -1, -1, -1, -1},         // 30
     {4, 7, 11, 4, 11, 9, 9, 11, 10, -1, -1, -1, -1, -1, -1, -1},      // 31
     {9, 5, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},    // 32
     {9, 5, 4, 0, 8, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},       // 33
     {0, 5, 4, 1, 5, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},       // 34
     {8, 5, 4, 8, 3, 5, 3, 1, 5, -1, -1, -1, -1, -1, -1, -1},          // 35
     {1, 2, 10, 9, 5, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 36
     {3, 0, 8, 1, 2, 10, 4, 9, 5, -1, -1, -1, -1, -1, -1, -1},         // 37
     {5, 2, 10, 5, 4, 2, 4, 0, 2, -1, -1, -1, -1, -1, -1, -1},         // 38
     {2, 10, 5, 3, 2, 5, 3, 5, 4, 3, 4, 8, -1, -1, -1, -1},            // 39
     {9, 5, 4, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 40
     {0, 11, 2, 0, 8, 11, 4, 9, 5, -1, -1, -1, -1, -1, -1, -1},
     {0, 5, 4, 0, 1, 5, 2, 3, 11, -1, -1, -1, -1, -1, -1, -1},
     {2, 1, 5, 2, 5, 8, 2, 8, 11, 4, 8, 5, -1, -1, -1, -1},
     {10, 3, 11, 10, 1, 3, 9, 5, 4, -1, -1, -1, -1, -1, -1, -1},
     {4, 9, 5, 0, 8, 1, 8, 10, 1, 8, 11, 10, -1, -1, -1, -1},          // 45
     {5, 4, 0, 5, 0, 11, 5, 11, 10, 11, 0, 3, -1, -1, -1, -1},
     {5, 4, 8, 5, 8, 10, 10, 8, 11, -1, -1, -1, -1, -1, -1, -1},
     {9, 7, 8, 5, 7, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {9, 3, 0, 9, 5, 3, 5, 7, 3, -1, -1, -1, -1, -1, -1, -1},
     {0, 7, 8, 0, 1, 7, 1, 5, 7, -1, -1, -1, -1, -1, -1, -1},          // 50
     {1, 5, 3, 3, 5, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {9, 7, 8, 9, 5, 7, 10, 1, 2, -1, -1, -1, -1, -1, -1, -1},
     {10, 1, 2, 9, 5, 0, 5, 3, 0, 5, 7, 3, -1, -1, -1, -1},
     {8, 0, 2, 8, 2, 5, 8, 5, 7, 10, 5, 2, -1, -1, -1, -1},
     {2, 10, 5, 2, 5, 3, 3, 5, 7, -1, -1, -1, -1, -1, -1, -1},         // 55
     {7, 9, 5, 7, 8, 9, 3, 11, 2, -1, -1, -1, -1, -1, -1, -1},
     {9, 5, 7, 9, 7, 2, 9, 2, 0, 2, 7, 11, -1, -1, -1, -1},
     {2, 3, 11, 0, 1, 8, 1, 7, 8, 1, 5, 7, -1, -1, -1, -1},
     {11, 2, 1, 11, 1, 7, 7, 1, 5, -1, -1, -1, -1, -1, -1, -1},
     {9, 5, 8, 8, 5, 7, 10, 1, 3, 10, 3, 11, -1, -1, -1, -1},          // 60
     {5, 7, 0, 5, 0, 9, 7, 11, 0, 1, 0, 10, 11, 10, 0, -1},
     {11, 10, 0, 11, 0, 3, 10, 5, 0, 8, 0, 7, 5, 7, 0, -1},
     {11, 10, 5, 7, 11, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {10, 6, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {0, 8, 3, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 65
     {9, 0, 1, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {1, 8, 3, 1, 9, 8, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1},
     {1, 6, 5, 2, 6, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {1, 6, 5, 1, 2, 6, 3, 0, 8, -1, -1, -1, -1, -1, -1, -1},
     {9, 6, 5, 9, 0, 6, 0, 2, 6, -1, -1, -1, -1, -1, -1, -1},          // 70
     {5, 9, 8, 5, 8, 2, 5, 2, 6, 3, 2, 8, -1, -1, -1, -1},
     {2, 3, 11, 10, 6, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {11, 0, 8, 11, 2, 0, 10, 6, 5, -1, -1, -1, -1, -1, -1, -1},
     {0, 1, 9, 2, 3, 11, 5, 10, 6, -1, -1, -1, -1, -1, -1, -1},
     {5, 10, 6, 1, 9, 2, 9, 11, 2, 9, 8, 11, -1, -1, -1, -1},          // 75
     {6, 3, 11, 6, 5, 3, 5, 1, 3, -1, -1, -1, -1, -1, -1, -1},
     {0, 8, 11, 0, 11, 5, 0, 5, 1, 5, 11, 6, -1, -1, -1, -1},
     {3, 11, 6, 0, 3, 6, 0, 6, 5, 0, 5, 9, -1, -1, -1, -1},
     {6, 5, 9, 6, 9, 11, 11, 9, 8, -1, -1, -1, -1, -1, -1, -1},
     {5, 10, 6, 4, 7, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 80
     {4, 3, 0, 4, 7, 3, 6, 5, 10, -1, -1, -1, -1, -1, -1, -1},
     {1, 9, 0, 5, 10, 6, 8, 4, 7, -1, -1, -1, -1, -1, -1, -1},
     {10, 6, 5, 1, 9, 7, 1, 7, 3, 7, 9, 4, -1, -1, -1, -1},
     {6, 1, 2, 6, 5, 1, 4, 7, 8, -1, -1, -1, -1, -1, -1, -1},
     {1, 2, 5, 5, 2, 6, 3, 0, 4, 3, 4, 7, -1, -1, -1, -1},             // 85
     {8, 4, 7, 9, 0, 5, 0, 6, 5, 0, 2, 6, -1, -1, -1, -1},
     {7, 3, 9, 7, 9, 4, 3, 2, 9, 5, 9, 6, 2, 6, 9, -1},
     {3, 11, 2, 7, 8, 4, 10, 6, 5, -1, -1, -1, -1, -1, -1, -1},
     {5, 10, 6, 4, 7, 2, 4, 2, 0, 2, 7, 11, -1, -1, -1, -1},
     {0, 1, 9, 4, 7, 8, 2, 3, 11, 5, 10, 6, -1, -1, -1, -1},           // 90
     {9, 2, 1, 9, 11, 2, 9, 4, 11, 7, 11, 4, 5, 10, 6, -1},
     {8, 4, 7, 3, 11, 5, 3, 5, 1, 5, 11, 6, -1, -1, -1, -1},
     {5, 1, 11, 5, 11, 6, 1, 0, 11, 7, 11, 4, 0, 4, 11, -1},
     {0, 5, 9, 0, 6, 5, 0, 3, 6, 11, 6, 3, 8, 4, 7, -1},
     {6, 5, 9, 6, 9, 11, 4, 7, 9, 7, 11, 9, -1, -1, -1, -1},           // 95
     {10, 4, 9, 6, 4, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {4, 10, 6, 4, 9, 10, 0, 8, 3, -1, -1, -1, -1, -1, -1, -1},
     {10, 0, 1, 10, 6, 0, 6, 4, 0, -1, -1, -1, -1, -1, -1, -1},
     {8, 3, 1, 8, 1, 6, 8, 6, 4, 6, 1, 10, -1, -1, -1, -1},
     {1, 4, 9, 1, 2, 4, 2, 6, 4, -1, -1, -1, -1, -1, -1, -1},          // 100     
     {3, 0, 8, 1, 2, 9, 2, 4, 9, 2, 6, 4, -1, -1, -1, -1},
     {0, 2, 4, 4, 2, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {8, 3, 2, 8, 2, 4, 4, 2, 6, -1, -1, -1, -1, -1, -1, -1},
     {10, 4, 9, 10, 6, 4, 11, 2, 3, -1, -1, -1, -1, -1, -1, -1},
     {0, 8, 2, 2, 8, 11, 4, 9, 10, 4, 10, 6, -1, -1, -1, -1},          // 105
     {3, 11, 2, 0, 1, 6, 0, 6, 4, 6, 1, 10, -1, -1, -1, -1},
     {6, 4, 1, 6, 1, 10, 4, 8, 1, 2, 1, 11, 8, 11, 1, -1},
     {9, 6, 4, 9, 3, 6, 9, 1, 3, 11, 6, 3, -1, -1, -1, -1},
     {8, 11, 1, 8, 1, 0, 11, 6, 1, 9, 1, 4, 6, 4, 1, -1},
     {3, 11, 6, 3, 6, 0, 0, 6, 4, -1, -1, -1, -1, -1, -1, -1},         // 110
     {6, 4, 8, 11, 6, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {7, 10, 6, 7, 8, 10, 8, 9, 10, -1, -1, -1, -1, -1, -1, -1},
     {0, 7, 3, 0, 10, 7, 0, 9, 10, 6, 7, 10, -1, -1, -1, -1},
     {10, 6, 7, 1, 10, 7, 1, 7, 8, 1, 8, 0, -1, -1, -1, -1},
     {10, 6, 7, 10, 7, 1, 1, 7, 3, -1, -1, -1, -1, -1, -1, -1},        // 115 
     {1, 2, 6, 1, 6, 8, 1, 8, 9, 8, 6, 7, -1, -1, -1, -1},
     {2, 6, 9, 2, 9, 1, 6, 7, 9, 0, 9, 3, 7, 3, 9, -1},
     {7, 8, 0, 7, 0, 6, 6, 0, 2, -1, -1, -1, -1, -1, -1, -1},
     {7, 3, 2, 6, 7, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {2, 3, 11, 10, 6, 8, 10, 8, 9, 8, 6, 7, -1, -1, -1, -1},          // 120
     {2, 0, 7, 2, 7, 11, 0, 9, 7, 6, 7, 10, 9, 10, 7, -1},
     {1, 8, 0, 1, 7, 8, 1, 10, 7, 6, 7, 10, 2, 3, 11, -1},
     {11, 2, 1, 11, 1, 7, 10, 6, 1, 6, 7, 1, -1, -1, -1, -1},
     {8, 9, 6, 8, 6, 7, 9, 1, 6, 11, 6, 3, 1, 3, 6, -1},
     {0, 9, 1, 11, 6, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 125
     {7, 8, 0, 7, 0, 6, 3, 11, 0, 11, 6, 0, -1, -1, -1, -1},
     {7, 11, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {7, 6, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {3, 0, 8, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {0, 1, 9, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 130
     {8, 1, 9, 8, 3, 1, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1},
     {10, 1, 2, 6, 11, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {1, 2, 10, 3, 0, 8, 6, 11, 7, -1, -1, -1, -1, -1, -1, -1},
     {2, 9, 0, 2, 10, 9, 6, 11, 7, -1, -1, -1, -1, -1, -1, -1},
     {6, 11, 7, 2, 10, 3, 10, 8, 3, 10, 9, 8, -1, -1, -1, -1},         // 135
     {7, 2, 3, 6, 2, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {7, 0, 8, 7, 6, 0, 6, 2, 0, -1, -1, -1, -1, -1, -1, -1},
     {2, 7, 6, 2, 3, 7, 0, 1, 9, -1, -1, -1, -1, -1, -1, -1},
     {1, 6, 2, 1, 8, 6, 1, 9, 8, 8, 7, 6, -1, -1, -1, -1},
     {10, 7, 6, 10, 1, 7, 1, 3, 7, -1, -1, -1, -1, -1, -1, -1},        // 140
     {10, 7, 6, 1, 7, 10, 1, 8, 7, 1, 0, 8, -1, -1, -1, -1},
     {0, 3, 7, 0, 7, 10, 0, 10, 9, 6, 10, 7, -1, -1, -1, -1},
     {7, 6, 10, 7, 10, 8, 8, 10, 9, -1, -1, -1, -1, -1, -1, -1},
     {6, 8, 4, 11, 8, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {3, 6, 11, 3, 0, 6, 0, 4, 6, -1, -1, -1, -1, -1, -1, -1},         // 145
     {8, 6, 11, 8, 4, 6, 9, 0, 1, -1, -1, -1, -1, -1, -1, -1},
     {9, 4, 6, 9, 6, 3, 9, 3, 1, 11, 3, 6, -1, -1, -1, -1},
     {6, 8, 4, 6, 11, 8, 2, 10, 1, -1, -1, -1, -1, -1, -1, -1},
     {1, 2, 10, 3, 0, 11, 0, 6, 11, 0, 4, 6, -1, -1, -1, -1},
     {4, 11, 8, 4, 6, 11, 0, 2, 9, 2, 10, 9, -1, -1, -1, -1},          // 150
     {10, 9, 3, 10, 3, 2, 9, 4, 3, 11, 3, 6, 4, 6, 3, -1},
     {8, 2, 3, 8, 4, 2, 4, 6, 2, -1, -1, -1, -1, -1, -1, -1},
     {0, 4, 2, 4, 6, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {1, 9, 0, 2, 3, 4, 2, 4, 6, 4, 3, 8, -1, -1, -1, -1},
     {1, 9, 4, 1, 4, 2, 2, 4, 6, -1, -1, -1, -1, -1, -1, -1},          // 155
     {8, 1, 3, 8, 6, 1, 8, 4, 6, 6, 10, 1, -1, -1, -1, -1},
     {10, 1, 0, 10, 0, 6, 6, 0, 4, -1, -1, -1, -1, -1, -1, -1},
     {4, 6, 3, 4, 3, 8, 6, 10, 3, 0, 3, 9, 10, 9, 3, -1},
     {10, 9, 4, 6, 10, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {4, 9, 5, 7, 6, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 160
     {0, 8, 3, 4, 9, 5, 11, 7, 6, -1, -1, -1, -1, -1, -1, -1},
     {5, 0, 1, 5, 4, 0, 7, 6, 11, -1, -1, -1, -1, -1, -1, -1},
     {11, 7, 6, 8, 3, 4, 3, 5, 4, 3, 1, 5, -1, -1, -1, -1},
     {9, 5, 4, 10, 1, 2, 7, 6, 11, -1, -1, -1, -1, -1, -1, -1},
     {6, 11, 7, 1, 2, 10, 0, 8, 3, 4, 9, 5, -1, -1, -1, -1},           // 165
     {7, 6, 11, 5, 4, 10, 4, 2, 10, 4, 0, 2, -1, -1, -1, -1},
     {3, 4, 8, 3, 5, 4, 3, 2, 5, 10, 5, 2, 11, 7, 6, -1},
     {7, 2, 3, 7, 6, 2, 5, 4, 9, -1, -1, -1, -1, -1, -1, -1},
     {9, 5, 4, 0, 8, 6, 0, 6, 2, 6, 8, 7, -1, -1, -1, -1},
     {3, 6, 2, 3, 7, 6, 1, 5, 0, 5, 4, 0, -1, -1, -1, -1},             // 170
     {6, 2, 8, 6, 8, 7, 2, 1, 8, 4, 8, 5, 1, 5, 8, -1},
     {9, 5, 4, 10, 1, 6, 1, 7, 6, 1, 3, 7, -1, -1, -1, -1},
     {1, 6, 10, 1, 7, 6, 1, 0, 7, 8, 7, 0, 9, 5, 4, -1},
     {4, 0, 10, 4, 10, 5, 0, 3, 10, 6, 10, 7, 3, 7, 10, -1},
     {7, 6, 10, 7, 10, 8, 5, 4, 10, 4, 8, 10, -1, -1, -1, -1},         // 175
     {6, 9, 5, 6, 11, 9, 11, 8, 9, -1, -1, -1, -1, -1, -1, -1},
     {3, 6, 11, 0, 6, 3, 0, 5, 6, 0, 9, 5, -1, -1, -1, -1},
     {0, 11, 8, 0, 5, 11, 0, 1, 5, 5, 6, 11, -1, -1, -1, -1},
     {6, 11, 3, 6, 3, 5, 5, 3, 1, -1, -1, -1, -1, -1, -1, -1},
     {1, 2, 10, 9, 5, 11, 9, 11, 8, 11, 5, 6, -1, -1, -1, -1},         // 180
     {0, 11, 3, 0, 6, 11, 0, 9, 6, 5, 6, 9, 1, 2, 10, -1},
     {11, 8, 5, 11, 5, 6, 8, 0, 5, 10, 5, 2, 0, 2, 5, -1},
     {6, 11, 3, 6, 3, 5, 2, 10, 3, 10, 5, 3, -1, -1, -1, -1},
     {5, 8, 9, 5, 2, 8, 5, 6, 2, 3, 8, 2, -1, -1, -1, -1},
     {9, 5, 6, 9, 6, 0, 0, 6, 2, -1, -1, -1, -1, -1, -1, -1},          // 185
     {1, 5, 8, 1, 8, 0, 5, 6, 8, 3, 8, 2, 6, 2, 8, -1},
     {1, 5, 6, 2, 1, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {1, 3, 6, 1, 6, 10, 3, 8, 6, 5, 6, 9, 8, 9, 6, -1},
     {10, 1, 0, 10, 0, 6, 9, 5, 0, 5, 6, 0, -1, -1, -1, -1},
     {0, 3, 8, 5, 6, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 190
     {10, 5, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {11, 5, 10, 7, 5, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {11, 5, 10, 11, 7, 5, 8, 3, 0, -1, -1, -1, -1, -1, -1, -1},
     {5, 11, 7, 5, 10, 11, 1, 9, 0, -1, -1, -1, -1, -1, -1, -1},
     {10, 7, 5, 10, 11, 7, 9, 8, 1, 8, 3, 1, -1, -1, -1, -1},          // 195
     {11, 1, 2, 11, 7, 1, 7, 5, 1, -1, -1, -1, -1, -1, -1, -1},
     {0, 8, 3, 1, 2, 7, 1, 7, 5, 7, 2, 11, -1, -1, -1, -1},
     {9, 7, 5, 9, 2, 7, 9, 0, 2, 2, 11, 7, -1, -1, -1, -1},
     {7, 5, 2, 7, 2, 11, 5, 9, 2, 3, 2, 8, 9, 8, 2, -1},
     {2, 5, 10, 2, 3, 5, 3, 7, 5, -1, -1, -1, -1, -1, -1, -1},         // 200
     {8, 2, 0, 8, 5, 2, 8, 7, 5, 10, 2, 5, -1, -1, -1, -1},
     {9, 0, 1, 5, 10, 3, 5, 3, 7, 3, 10, 2, -1, -1, -1, -1},
     {9, 8, 2, 9, 2, 1, 8, 7, 2, 10, 2, 5, 7, 5, 2, -1},
     {1, 3, 5, 3, 7, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {0, 8, 7, 0, 7, 1, 1, 7, 5, -1, -1, -1, -1, -1, -1, -1},          // 205
     {9, 0, 3, 9, 3, 5, 5, 3, 7, -1, -1, -1, -1, -1, -1, -1},
     {9, 8, 7, 5, 9, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {5, 8, 4, 5, 10, 8, 10, 11, 8, -1, -1, -1, -1, -1, -1, -1},
     {5, 0, 4, 5, 11, 0, 5, 10, 11, 11, 3, 0, -1, -1, -1, -1},
     {0, 1, 9, 8, 4, 10, 8, 10, 11, 10, 4, 5, -1, -1, -1, -1},         // 210
     {10, 11, 4, 10, 4, 5, 11, 3, 4, 9, 4, 1, 3, 1, 4, -1},
     {2, 5, 1, 2, 8, 5, 2, 11, 8, 4, 5, 8, -1, -1, -1, -1},
     {0, 4, 11, 0, 11, 3, 4, 5, 11, 2, 11, 1, 5, 1, 11, -1},
     {0, 2, 5, 0, 5, 9, 2, 11, 5, 4, 5, 8, 11, 8, 5, -1},
     {9, 4, 5, 2, 11, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 215
     {2, 5, 10, 3, 5, 2, 3, 4, 5, 3, 8, 4, -1, -1, -1, -1},
     {5, 10, 2, 5, 2, 4, 4, 2, 0, -1, -1, -1, -1, -1, -1, -1},
     {3, 10, 2, 3, 5, 10, 3, 8, 5, 4, 5, 8, 0, 1, 9, -1},
     {5, 10, 2, 5, 2, 4, 1, 9, 2, 9, 4, 2, -1, -1, -1, -1},
     {8, 4, 5, 8, 5, 3, 3, 5, 1, -1, -1, -1, -1, -1, -1, -1},          // 220
     {0, 4, 5, 1, 0, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {8, 4, 5, 8, 5, 3, 9, 0, 5, 0, 3, 5, -1, -1, -1, -1},
     {9, 4, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {4, 11, 7, 4, 9, 11, 9, 10, 11, -1, -1, -1, -1, -1, -1, -1},
     {0, 8, 3, 4, 9, 7, 9, 11, 7, 9, 10, 11, -1, -1, -1, -1},          // 225
     {1, 10, 11, 1, 11, 4, 1, 4, 0, 7, 4, 11, -1, -1, -1, -1},
     {3, 1, 4, 3, 4, 8, 1, 10, 4, 7, 4, 11, 10, 11, 4, -1},
     {4, 11, 7, 9, 11, 4, 9, 2, 11, 9, 1, 2, -1, -1, -1, -1},
     {9, 7, 4, 9, 11, 7, 9, 1, 11, 2, 11, 1, 0, 8, 3, -1},
     {11, 7, 4, 11, 4, 2, 2, 4, 0, -1, -1, -1, -1, -1, -1, -1},        // 230
     {11, 7, 4, 11, 4, 2, 8, 3, 4, 3, 2, 4, -1, -1, -1, -1},
     {2, 9, 10, 2, 7, 9, 2, 3, 7, 7, 4, 9, -1, -1, -1, -1},
     {9, 10, 7, 9, 7, 4, 10, 2, 7, 8, 7, 0, 2, 0, 7, -1},
     {3, 7, 10, 3, 10, 2, 7, 4, 10, 1, 10, 0, 4, 0, 10, -1},
     {1, 10, 2, 8, 7, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},      // 235
     {4, 9, 1, 4, 1, 7, 7, 1, 3, -1, -1, -1, -1, -1, -1, -1},
     {4, 9, 1, 4, 1, 7, 0, 8, 1, 8, 7, 1, -1, -1, -1, -1},
     {4, 0, 3, 7, 4, 3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {4, 8, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {9, 10, 8, 10, 11, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},    // 240
     {3, 0, 9, 3, 9, 11, 11, 9, 10, -1, -1, -1, -1, -1, -1, -1},
     {0, 1, 10, 0, 10, 8, 8, 10, 11, -1, -1, -1, -1, -1, -1, -1},
     {3, 1, 10, 11, 3, 10, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {1, 2, 11, 1, 11, 9, 9, 11, 8, -1, -1, -1, -1, -1, -1, -1},
     {3, 0, 9, 3, 9, 11, 1, 2, 9, 2, 11, 9, -1, -1, -1, -1},           // 245
     {0, 2, 11, 8, 0, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {3, 2, 11, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {2, 3, 8, 2, 8, 10, 10, 8, 9, -1, -1, -1, -1, -1, -1, -1},
     {9, 10, 2, 0, 9, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {2, 3, 8, 2, 8, 10, 0, 1, 8, 1, 10, 8, -1, -1, -1, -1},           // 250
     {1, 10, 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {1, 3, 8, 9, 1, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {0, 9, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {0, 3, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1},
     {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1}};// 255

int edge_code_to_case_id[4096] = {
255, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 0 - 9
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 10 - 19
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 20 - 29
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 30 - 39
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 40 - 49
-1, 221, -1, -1, -1, -1, -1, -1, -1, -1,  // 50 - 59
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 60 - 69
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 70 - 79
-1, -1, -1, -1, -1, 153, -1, -1, -1, -1,  // 80 - 89
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 90 - 99
-1, -1, 187, -1, -1, -1, -1, -1, -1, -1,  // 100 - 109
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 110 - 119
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 120 - 129
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 130 - 139
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 140 - 149
-1, -1, -1, 238, -1, -1, -1, -1, -1, -1,  // 150 - 159
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 160 - 169
204, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 170 - 179
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 180 - 189
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 190 - 199
-1, -1, -1, -1, 136, -1, -1, -1, -1, -1,  // 200 - 209
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 210 - 219
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 220 - 229
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 230 - 239
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 240 - 249
-1, -1, -1, -1, -1, 170, -1, -1, -1, -1,  // 250 - 259
-1, -1, -1, -1, -1, 254, -1, -1, -1, -1,  // 260 - 269
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 270 - 279
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 280 - 289
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 290 - 299
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 300 - 309
-1, -1, -1, -1, 220, -1, -1, -1, -1, -1,  // 310 - 319
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 320 - 329
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 330 - 339
-1, -1, -1, -1, -1, -1, -1, -1, 152, -1,  // 340 - 349
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 350 - 359
-1, -1, -1, -1, -1, -1, -1, 186, -1, -1,  // 360 - 369
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 370 - 379
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 380 - 389
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 390 - 399
239, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 400 - 409
-1, -1, -1, -1, -1, -1, -1, -1, -1, 205,  // 410 - 419
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 420 - 429
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 430 - 439
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 440 - 449
-1, -1, -1, 137, -1, -1, -1, -1, -1, -1,  // 450 - 459
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 460 - 469
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 470 - 479
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 480 - 489
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 490 - 499
-1, -1, 171, -1, -1, -1, -1, -1, -1, -1,  // 500 - 509
-1, -1, -1, -1, -1, 253, -1, -1, -1, -1,  // 510 - 519
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 520 - 529
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 530 - 539
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 540 - 549
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 550 - 559
223, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 560 - 569
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 570 - 579
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 580 - 589
-1, -1, -1, -1, -1, -1, -1, -1, 155, -1,  // 590 - 599
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 600 - 609
-1, -1, -1, 185, -1, -1, -1, -1, -1, -1,  // 610 - 619
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 620 - 629
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 630 - 639
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 640 - 649
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 650 - 659
-1, -1, -1, -1, -1, -1, 236, -1, -1, -1,  // 660 - 669
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 670 - 679
-1, 206, -1, -1, -1, -1, -1, -1, -1, -1,  // 680 - 689
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 690 - 699
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 700 - 709
-1, -1, -1, -1, -1, -1, -1, -1, -1, 138,  // 710 - 719
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 720 - 729
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 730 - 739
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 740 - 749
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 750 - 759
-1, -1, -1, -1, 168, -1, -1, -1, -1, -1,  // 760 - 769
-1, -1, -1, -1, -1, -1, -1, -1, 252, -1,  // 770 - 779
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 780 - 789
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 790 - 799
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 800 - 809
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 810 - 819
-1, -1, -1, -1, -1, 222, -1, -1, -1, -1,  // 820 - 829
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 830 - 839
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 840 - 849
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 850 - 859
-1, -1, -1, 154, -1, -1, -1, -1, -1, -1,  // 860 - 869
-1, -1, -1, -1, -1, -1, 184, -1, -1, -1,  // 870 - 879
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 880 - 889
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 890 - 899
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 900 - 909
-1, -1, -1, -1, -1, 237, -1, -1, -1, -1,  // 910 - 919
-1, -1, -1, -1, -1, -1, -1, -1, 207, -1,  // 920 - 929
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 930 - 939
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 940 - 949
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 950 - 959
-1, -1, -1, -1, -1, -1, 139, -1, -1, -1,  // 960 - 969
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 970 - 979
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 980 - 989
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 990 - 999
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1000 - 1009
-1, -1, -1, 169, -1, -1, -1, -1, -1, -1,  // 1010 - 1019
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1020 - 1029
251, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 1030 - 1039
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1040 - 1049
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1050 - 1059
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1060 - 1069
-1, -1, -1, -1, -1, -1, -1, 217, -1, -1,  // 1070 - 1079
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1080 - 1089
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1090 - 1099
-1, -1, -1, -1, -1, -1, -1, 157, -1, -1,  // 1100 - 1109
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1110 - 1119
191, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 1120 - 1129
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1130 - 1139
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1140 - 1149
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1150 - 1159
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1160 - 1169
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1170 - 1179
-1, -1, -1, 234, -1, -1, -1, -1, -1, -1,  // 1180 - 1189
-1, -1, -1, -1, -1, -1, 200, -1, -1, -1,  // 1190 - 1199
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1200 - 1209
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1210 - 1219
-1, -1, -1, -1, -1, -1, 140, -1, -1, -1,  // 1220 - 1229
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1230 - 1239
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1240 - 1249
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1250 - 1259
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1260 - 1269
-1, -1, -1, 174, -1, -1, -1, -1, -1, -1,  // 1270 - 1279
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1280 - 1289
-1, -1, -1, -1, -1, 250, -1, -1, -1, -1,  // 1290 - 1299
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1300 - 1309
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1310 - 1319
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1320 - 1329
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1330 - 1339
216, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 1340 - 1349
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1350 - 1359
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1360 - 1369
156, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 1370 - 1379
-1, -1, -1, -1, -1, 190, -1, -1, -1, -1,  // 1380 - 1389
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1390 - 1399
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1400 - 1409
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1410 - 1419
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1420 - 1429
235, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 1430 - 1439
-1, -1, -1, -1, -1, 201, -1, -1, -1, -1,  // 1440 - 1449
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1450 - 1459
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1460 - 1469
-1, -1, -1, -1, -1, 141, -1, -1, -1, -1,  // 1470 - 1479
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1480 - 1489
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1490 - 1499
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1500 - 1509
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1510 - 1519
175, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 1520 - 1529
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1530 - 1539
-1, 249, -1, -1, -1, -1, -1, -1, -1, -1,  // 1540 - 1549
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1550 - 1559
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1560 - 1569
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1570 - 1579
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1580 - 1589
219, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 1590 - 1599
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1600 - 1609
-1, -1, -1, -1, -1, -1, 159, -1, -1, -1,  // 1610 - 1619
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1620 - 1629
-1, -1, -1, -1, -1, 189, -1, -1, -1, -1,  // 1630 - 1639
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1640 - 1649
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1650 - 1659
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1660 - 1669
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1670 - 1679
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1680 - 1689
-1, -1, 232, -1, -1, -1, -1, -1, -1, -1,  // 1690 - 1699
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1700 - 1709
-1, 202, -1, -1, -1, -1, -1, -1, -1, -1,  // 1710 - 1719
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1720 - 1729
-1, -1, -1, -1, -1, -1, -1, 142, -1, -1,  // 1730 - 1739
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1740 - 1749
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1750 - 1759
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1760 - 1769
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1770 - 1779
-1, -1, -1, -1, -1, -1, 172, -1, -1, -1,  // 1780 - 1789
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1790 - 1799
-1, -1, -1, -1, 248, -1, -1, -1, -1, -1,  // 1800 - 1809
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1810 - 1819
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1820 - 1829
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1830 - 1839
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1840 - 1849
-1, -1, -1, -1, -1, 218, -1, -1, -1, -1,  // 1850 - 1859
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1860 - 1869
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1870 - 1879
-1, 158, -1, -1, -1, -1, -1, -1, -1, -1,  // 1880 - 1889
-1, -1, -1, -1, -1, -1, -1, -1, 188, -1,  // 1890 - 1899
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1900 - 1909
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1910 - 1919
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1920 - 1929
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1930 - 1939
-1, 233, -1, -1, -1, -1, -1, -1, -1, -1,  // 1940 - 1949
-1, -1, -1, -1, -1, -1, -1, -1, 203, -1,  // 1950 - 1959
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1960 - 1969
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1970 - 1979
-1, -1, -1, -1, 143, -1, -1, -1, -1, -1,  // 1980 - 1989
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 1990 - 1999
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2000 - 2009
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2010 - 2019
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2020 - 2029
-1, -1, -1, -1, -1, 173, -1, -1, -1, -1,  // 2030 - 2039
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2040 - 2049
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2050 - 2059
247, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 2060 - 2069
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2070 - 2079
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2080 - 2089
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2090 - 2099
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2100 - 2109
-1, 213, -1, -1, -1, -1, -1, -1, -1, -1,  // 2110 - 2119
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2120 - 2129
-1, -1, -1, -1, -1, -1, -1, 145, -1, -1,  // 2130 - 2139
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2140 - 2149
-1, -1, -1, -1, 179, -1, -1, -1, -1, -1,  // 2150 - 2159
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2160 - 2169
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2170 - 2179
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2180 - 2189
-1, -1, -1, -1, -1, -1, -1, 230, -1, -1,  // 2190 - 2199
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2200 - 2209
-1, -1, -1, -1, 196, -1, -1, -1, -1, -1,  // 2210 - 2219
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2220 - 2229
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2230 - 2239
128, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 2240 - 2249
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2250 - 2259
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2260 - 2269
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2270 - 2279
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2280 - 2289
-1, 162, -1, -1, -1, -1, -1, -1, -1, -1,  // 2290 - 2299
-1, -1, -1, -1, -1, -1, -1, -1, -1, 246,  // 2300 - 2309
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2310 - 2319
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2320 - 2329
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2330 - 2339
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2340 - 2349
-1, -1, -1, -1, -1, -1, -1, -1, 212, -1,  // 2350 - 2359
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2360 - 2369
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2370 - 2379
-1, -1, -1, -1, 144, -1, -1, -1, -1, -1,  // 2380 - 2389
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2390 - 2399
-1, -1, -1, 178, -1, -1, -1, -1, -1, -1,  // 2400 - 2409
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2410 - 2419
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2420 - 2429
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2430 - 2439
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2440 - 2449
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2450 - 2459
231, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 2460 - 2469
-1, -1, -1, -1, -1, -1, -1, -1, -1, 197,  // 2470 - 2479
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2480 - 2489
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2490 - 2499
-1, -1, -1, -1, -1, 129, -1, -1, -1, -1,  // 2500 - 2509
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2510 - 2519
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2520 - 2529
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2530 - 2539
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2540 - 2549
-1, -1, -1, -1, 163, -1, -1, -1, -1, -1,  // 2550 - 2559
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2560 - 2569
-1, -1, -1, -1, -1, 245, -1, -1, -1, -1,  // 2570 - 2579
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2580 - 2589
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2590 - 2599
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2600 - 2609
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2610 - 2619
215, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 2620 - 2629
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2630 - 2639
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2640 - 2649
147, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 2650 - 2659
-1, -1, -1, -1, -1, 177, -1, -1, -1, -1,  // 2660 - 2669
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2670 - 2679
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2680 - 2689
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2690 - 2699
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2700 - 2709
228, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 2710 - 2719
-1, -1, -1, -1, -1, 198, -1, -1, -1, -1,  // 2720 - 2729
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2730 - 2739
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2740 - 2749
-1, -1, -1, -1, -1, 130, -1, -1, -1, -1,  // 2750 - 2759
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2760 - 2769
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2770 - 2779
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2780 - 2789
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2790 - 2799
160, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 2800 - 2809
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2810 - 2819
-1, -1, 244, -1, -1, -1, -1, -1, -1, -1,  // 2820 - 2829
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2830 - 2839
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2840 - 2849
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2850 - 2859
-1, -1, -1, -1, -1, -1, -1, -1, -1, 214,  // 2860 - 2869
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2870 - 2879
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2880 - 2889
-1, -1, -1, -1, -1, -1, -1, -1, -1, 146,  // 2890 - 2899
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2900 - 2909
-1, -1, 176, -1, -1, -1, -1, -1, -1, -1,  // 2910 - 2919
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2920 - 2929
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2930 - 2939
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2940 - 2949
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2950 - 2959
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2960 - 2969
-1, -1, -1, -1, -1, 229, -1, -1, -1, -1,  // 2970 - 2979
-1, -1, -1, -1, -1, -1, -1, -1, 199, -1,  // 2980 - 2989
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 2990 - 2999
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3000 - 3009
-1, -1, -1, -1, -1, -1, -1, -1, 131, -1,  // 3010 - 3019
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3020 - 3029
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3030 - 3039
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3040 - 3049
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3050 - 3059
-1, -1, -1, -1, -1, 161, -1, -1, -1, -1,  // 3060 - 3069
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3070 - 3079
-1, -1, 243, -1, -1, -1, -1, -1, -1, -1,  // 3080 - 3089
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3090 - 3099
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3100 - 3109
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3110 - 3119
-1, -1, -1, -1, -1, -1, -1, -1, -1, 209,  // 3120 - 3129
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3130 - 3139
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3140 - 3149
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3150 - 3159
-1, -1, -1, -1, -1, -1, -1, 149, -1, -1,  // 3160 - 3169
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3170 - 3179
183, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 3180 - 3189
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3190 - 3199
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3200 - 3209
-1, -1, -1, -1, -1, -1, -1, -1, -1, 226,  // 3210 - 3219
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3220 - 3229
-1, -1, 192, -1, -1, -1, -1, -1, -1, -1,  // 3230 - 3239
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3240 - 3249
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3250 - 3259
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3260 - 3269
132, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 3270 - 3279
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3280 - 3289
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3290 - 3299
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3300 - 3309
-1, -1, -1, -1, -1, -1, -1, 166, -1, -1,  // 3310 - 3319
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3320 - 3329
-1, 242, -1, -1, -1, -1, -1, -1, -1, -1,  // 3330 - 3339
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3340 - 3349
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3350 - 3359
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3360 - 3369
-1, -1, -1, -1, -1, -1, 208, -1, -1, -1,  // 3370 - 3379
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3380 - 3389
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3390 - 3399
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3400 - 3409
-1, -1, -1, -1, 148, -1, -1, -1, -1, -1,  // 3410 - 3419
-1, -1, -1, -1, -1, -1, -1, -1, -1, 182,  // 3420 - 3429
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3430 - 3439
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3440 - 3449
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3450 - 3459
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3460 - 3469
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3470 - 3479
-1, -1, 227, -1, -1, -1, -1, -1, -1, -1,  // 3480 - 3489
-1, -1, -1, -1, -1, -1, -1, 193, -1, -1,  // 3490 - 3499
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3500 - 3509
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3510 - 3519
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3520 - 3529
-1, -1, -1, -1, -1, 133, -1, -1, -1, -1,  // 3530 - 3539
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3540 - 3549
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3550 - 3559
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3560 - 3569
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3570 - 3579
167, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 3580 - 3589
-1, -1, -1, 241, -1, -1, -1, -1, -1, -1,  // 3590 - 3599
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3600 - 3609
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3610 - 3619
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3620 - 3629
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3630 - 3639
-1, -1, 211, -1, -1, -1, -1, -1, -1, -1,  // 3640 - 3649
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3650 - 3659
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3660 - 3669
-1, -1, -1, -1, -1, -1, 151, -1, -1, -1,  // 3670 - 3679
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3680 - 3689
-1, -1, -1, -1, -1, 181, -1, -1, -1, -1,  // 3690 - 3699
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3700 - 3709
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3710 - 3719
-1, -1, -1, -1, -1, -1, -1, -1, 224, -1,  // 3720 - 3729
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3730 - 3739
-1, -1, -1, -1, -1, -1, -1, 194, -1, -1,  // 3740 - 3749
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3750 - 3759
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3760 - 3769
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3770 - 3779
-1, 134, -1, -1, -1, -1, -1, -1, -1, -1,  // 3780 - 3789
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3790 - 3799
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3800 - 3809
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3810 - 3819
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3820 - 3829
164, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 3830 - 3839
240, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 3840 - 3849
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3850 - 3859
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3860 - 3869
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3870 - 3879
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3880 - 3889
-1, 210, -1, -1, -1, -1, -1, -1, -1, -1,  // 3890 - 3899
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3900 - 3909
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3910 - 3919
-1, -1, -1, -1, -1, 150, -1, -1, -1, -1,  // 3920 - 3929
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3930 - 3939
-1, -1, 180, -1, -1, -1, -1, -1, -1, -1,  // 3940 - 3949
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3950 - 3959
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3960 - 3969
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3970 - 3979
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 3980 - 3989
-1, -1, -1, 225, -1, -1, -1, -1, -1, -1,  // 3990 - 3999
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 4000 - 4009
195, -1, -1, -1, -1, -1, -1, -1, -1, -1,  // 4010 - 4019
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 4020 - 4029
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 4030 - 4039
-1, -1, -1, -1, 135, -1, -1, -1, -1, -1,  // 4040 - 4049
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 4050 - 4059
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 4060 - 4069
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 4070 - 4079
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,   // 4080 - 4089
-1, -1, -1, -1, -1, 165 }; // 4090 - 4095

int case_number(const std::array<bool, 12>& edges) {
    std::array<int, 8> states({{0, 0, 0, 0, 0, 0, 0, 0}});
    // 0: not set
    // -1 or 1: positive or negative value
    states[0] = -1; // arbitrary initialization
    // The following order ensures that vertices are visited in order
    int edges_order[] = {0, 1, 2, 8, 9, 10, 11, 3, 4, 5, 6, 7};
    for (int e = 0; e < 12; ++e)
    {
        int edgeid = edges_order[e];
        auto v0 = canonical_edge_indices[edgeid][0];
        auto v1 = canonical_edge_indices[edgeid][1];
        if (v0 > v1)
        {
            std::swap(v0, v1);
        }
        if (e < 7)
        {
            if (edges[edgeid])
                states[v1] = -states[v0];
            else
                states[v1] = states[v0];
        }
        else
        {
            if ((edges[edgeid] && edges[v1] * edges[v0] > 0) ||
                (!edges[edgeid] && edges[v1] * edges[v0] < 0))
                return -1; // failed
        }
    }

    int cn = 0;
    for (int i = 0; i < 8; ++i)
    {
        if (states[i] > 0)
        {
            cn += 1 << i;
        }
    }
    return cn;
}


} // namespace marching_cubes
} // namespace spurt